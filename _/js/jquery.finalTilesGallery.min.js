jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(t,e,i,n,s){return jQuery.easing[jQuery.easing.def](t,e,i,n,s)},easeInQuad:function(t,e,i,n,s){return n*(e/=s)*e+i},easeOutQuad:function(t,e,i,n,s){return-n*(e/=s)*(e-2)+i},easeInOutQuad:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e+i:-n/2*(--e*(e-2)-1)+i},easeInCubic:function(t,e,i,n,s){return n*(e/=s)*e*e+i},easeOutCubic:function(t,e,i,n,s){return n*((e=e/s-1)*e*e+1)+i},easeInOutCubic:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},easeInQuart:function(t,e,i,n,s){return n*(e/=s)*e*e*e+i},easeOutQuart:function(t,e,i,n,s){return-n*((e=e/s-1)*e*e*e-1)+i},easeInOutQuart:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e*e+i:-n/2*((e-=2)*e*e*e-2)+i},easeInQuint:function(t,e,i,n,s){return n*(e/=s)*e*e*e*e+i},easeOutQuint:function(t,e,i,n,s){return n*((e=e/s-1)*e*e*e*e+1)+i},easeInOutQuint:function(t,e,i,n,s){return(e/=s/2)<1?n/2*e*e*e*e*e+i:n/2*((e-=2)*e*e*e*e+2)+i},easeInSine:function(t,e,i,n,s){return-n*Math.cos(e/s*(Math.PI/2))+n+i},easeOutSine:function(t,e,i,n,s){return n*Math.sin(e/s*(Math.PI/2))+i},easeInOutSine:function(t,e,i,n,s){return-n/2*(Math.cos(Math.PI*e/s)-1)+i},easeInExpo:function(t,e,i,n,s){return 0==e?i:n*Math.pow(2,10*(e/s-1))+i},easeOutExpo:function(t,e,i,n,s){return e==s?i+n:n*(-Math.pow(2,-10*e/s)+1)+i},easeInOutExpo:function(t,e,i,n,s){return 0==e?i:e==s?i+n:(e/=s/2)<1?n/2*Math.pow(2,10*(e-1))+i:n/2*(-Math.pow(2,-10*--e)+2)+i},easeInCirc:function(t,e,i,n,s){return-n*(Math.sqrt(1-(e/=s)*e)-1)+i},easeOutCirc:function(t,e,i,n,s){return n*Math.sqrt(1-(e=e/s-1)*e)+i},easeInOutCirc:function(t,e,i,n,s){return(e/=s/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+i:n/2*(Math.sqrt(1-(e-=2)*e)+1)+i},easeInElastic:function(t,e,i,n,s){var a=1.70158,o=0,r=n;if(0==e)return i;if(1==(e/=s))return i+n;if(o||(o=.3*s),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return-(r*Math.pow(2,10*(e-=1))*Math.sin(2*(e*s-a)*Math.PI/o))+i},easeOutElastic:function(t,e,i,n,s){var a=1.70158,o=0,r=n;if(0==e)return i;if(1==(e/=s))return i+n;if(o||(o=.3*s),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return r*Math.pow(2,-10*e)*Math.sin(2*(e*s-a)*Math.PI/o)+n+i},easeInOutElastic:function(t,e,i,n,s){var a=1.70158,o=0,r=n;if(0==e)return i;if(2==(e/=s/2))return i+n;if(o||(o=.3*s*1.5),r<Math.abs(n)){r=n;var a=o/4}else var a=o/(2*Math.PI)*Math.asin(n/r);return 1>e?-.5*r*Math.pow(2,10*(e-=1))*Math.sin(2*(e*s-a)*Math.PI/o)+i:r*Math.pow(2,-10*(e-=1))*Math.sin(2*(e*s-a)*Math.PI/o)*.5+n+i},easeInBack:function(t,e,i,n,s,a){return void 0==a&&(a=1.70158),n*(e/=s)*e*((a+1)*e-a)+i},easeOutBack:function(t,e,i,n,s,a){return void 0==a&&(a=1.70158),n*((e=e/s-1)*e*((a+1)*e+a)+1)+i},easeInOutBack:function(t,e,i,n,s,a){return void 0==a&&(a=1.70158),(e/=s/2)<1?n/2*e*e*(((a*=1.525)+1)*e-a)+i:n/2*((e-=2)*e*(((a*=1.525)+1)*e+a)+2)+i},easeInBounce:function(t,e,i,n,s){return n-jQuery.easing.easeOutBounce(t,s-e,0,n,s)+i},easeOutBounce:function(t,e,i,n,s){return(e/=s)<1/2.75?7.5625*n*e*e+i:2/2.75>e?n*(7.5625*(e-=1.5/2.75)*e+.75)+i:2.5/2.75>e?n*(7.5625*(e-=2.25/2.75)*e+.9375)+i:n*(7.5625*(e-=2.625/2.75)*e+.984375)+i},easeInOutBounce:function(t,e,i,n,s){return s/2>e?.5*jQuery.easing.easeInBounce(t,2*e,0,n,s)+i:.5*jQuery.easing.easeOutBounce(t,2*e-s,0,n,s)+.5*n+i}}),function(t){t.fn.visible=function(e){if(!t(this).offset())return!0;var i=t(this),n=t(window),s=n.scrollTop(),a=s+n.height(),o=i.offset().top,r=o+i.height(),h=e===!0?r:o,l=e===!0?o:r;return a>=l&&h>=s},t.finalTilesGallery=function(e,i){function n(){var t=document.body||document.documentElement,e=t.style,i="transition";if("string"==typeof e[i])return!0;v=["Moz","Webkit","Khtml","O","ms"],i=i.charAt(0).toUpperCase()+i.substr(1);for(var n=0;n<v.length;n++)if("string"==typeof e[v[n]+i])return!0;return!1}var s=function(t,e,i){this.position={x:0,y:0},this.blocks={h:Math.floor(e/t),v:Math.floor(i/t)},this.size={width:this.blocks.h*t,height:this.blocks.v*t},this.px={width:e,height:i},this.cell_size=t,this.edge_right=!1};s.prototype.resize=function(t,e){{var i=t*this.cell_size,n=i*this.px.height/this.px.width;this.blocks.v}this.blocks.h=t,e||(this.blocks.v=Math.floor(n/this.cell_size))};var a=function(t,e,i,n){this.slots=[],this.cells=[],this.margin=e,this.min_tile_width=i,this.cell_size=t,this.width=n,this.hor_size=Math.floor(n/t),this.init()};a.prototype.init=function(){this.slots.length=0,this.cells.length=0;for(var t=0;t<100*this.hor_size;t++)this.cells[t]=0},a.prototype.add_slot=function(t){for(var e=0;e<t.blocks.v;e++)for(var i=0;i<t.blocks.h;i++){var n=t.position.y+e,s=t.position.x+i;this.cells[n*this.hor_size+s]=1,this.cells.push(0)}this.slots.push(t)},a.prototype.count_free_cells_on_right=function(t){for(var e=Math.floor(t/this.hor_size),i=(e+1)*this.hor_size,n=0;i>t&&1!=this.cells[t];t++,n++);return n},a.prototype.insert=function(t,e,i){var n=new s(this.cell_size,t,e),a=0,o=0,h=0;if(0==this.slots.length)a=this.hor_size,n.position.x=0,n.position.y=0;else for(;o<this.cells.length;o++)if(0==this.cells[o]){h=Math.floor(o/this.hor_size);var l=(h+1)*this.hor_size;a=0;for(var c=0;l-o>=c&&(a=c,1!=this.cells[o+c]);c++);break}if(a<n.blocks.h)n.resize(a);else{var f=this.count_free_cells_on_right(o+n.blocks.h);f*this.cell_size-r.settings.margin<this.min_tile_width&&f>0&&(n.resize(a,!i),n.enlarged=!0),0==f&&(n.edge_right=!0)}return n.position.x=o%this.hor_size,n.position.y=Math.floor(o/this.hor_size),this.add_slot(n),n},a.prototype.print=function(){for(var e="",i=1;i<=this.cells.length;i++)e+=1==this.cells[i-1]?"██":"__",i>0&&i%this.hor_size==0&&(e+="\n");t("pre").text(e)};var o={margin:10,minTileWidth:200,autoLoadURL:null,autoLoadOffset:50,gridCellSize:10,scrollEffect:"zoom",enableTwitter:!1,twitterText:"",enableFacebook:!1,facebookText:"",enableGplus:!1,enablePinterest:!1,allowEnlargement:!0,hoverEffect:"fade",hoverEasing:"swing",hoverEffectDuration:250,ignoreImageAttributes:!0,imageSizeFactor:1,onComplete:function(){},onUpdate:function(){}},r=this,h=null,l=(n(),!1),c=!1,f=1,d=!1,u=0;r.settings={};var g=t(e),e=e,p=g.width(),w=!1,m=function(){0!=g.find(".ftg-filters").length&&g.find(".ftg-filters a").click(function(e){if(e.preventDefault(),l=!0,u=0,!t(this).hasClass("selected")){g.find(".ftg-filters .selected").add(this).toggleClass("selected");var i=t(this).attr("href").substr(1),n=t("void");h=null,i.length>0?(g.find(".tile").addClass("ftg-hidden").hide().css({bottom:0,left:"50%"}),n=g.find(".ftg-"+i).show().removeClass("ftg-hidden")):n=g.find(".tile").removeClass("ftg-hidden").show(),Q(n)}})};r.addElements=function(e){var i=t("<div />").hide();i.append(e);var n=i.find(".tile");T(n,{top:t(window).scrollTop()+500}),b(n),t("body").append(i),n.appendTo(g.find(".ftg-items")),i.remove(),O(n)},r.showLoading=function(){var e=t("<div class='ftg-loading-panel' />");e.append("<p>Loading</p>"),e.hide(),t("body").append(e),e.fadeIn()},r.hideLoading=function(){t(".ftg-loading-panel").fadeOut("fast",function(){t(this).remove()})},r.init=function(){r.settings=t.extend({},o,i),g.find(".ftg-items").css({position:"relative",minWidth:r.settings.minTileWidth});var e=g.find(".tile");T(e),m(),O(e),d=r.settings.enableFacebook||r.settings.enableGplus||r.settings.enableTwitter||r.settings.enablePinterest,d&&b(e);var n=0;t(window).resize(function(){clearTimeout(n),p!=g.width()&&(n=setTimeout(function(){h=null,u=0,l=!0,Q(g.find(".tile"))},200))});var s=t(".tile");t(window).scroll(function(){s.each(function(t){var e=s.eq(t);e.visible(!0)&&(s.splice(t,1),e.addClass("effect-"+r.settings.scrollEffect).removeClass("module"))})});var a=!1;r.settings.autoLoadURL&&t(window).scroll(function(){!a&&!c&&t(window).scrollTop()>=t(document).height()-t(window).height()-r.settings.autoLoadOffset&&(c=!0,r.showLoading(),t.get(r.settings.autoLoadURL,{page:++f},function(e){0==t.trim(e).length?a=!0:r.addElements(e)}))})};var b=function(e){e.each(function(e,i){var n=t(i);n.append("<div class='ftg-social' />")}),r.settings.enableTwitter&&I(e),r.settings.enableFacebook&&k(e),r.settings.enableGplus&&_(e),r.settings.enablePinterest&&M(e)},y=function(e,i){e.find(".ftg-social").each(function(e,n){var s=t(n),a=t("<a class='"+i+"' href='#'></a>");s.append(a)})},z=function(t){var e=document.createElement("img");return e.src=t,t=e.src,e.src=null,t},I=function(e){y(e,"tw-icon fa fa-twitter","Twitter"),e.find(".tw-icon").click(function(e){e.preventDefault();var i=t(this).parents(".tile:first").find(".caption"),n=r.settings.twitterText||document.title;!r.settings.twitterText&&1==i.length&&i.text().length>0&&(n=t.trim(i.text()));var s=window.open("https://twitter.com/intent/tweet?url="+encodeURI(location.href.split("#")[0])+"&text="+encodeURI(n),"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");s.moveTo(screen.width/2-300,screen.height/2-200)})},k=function(e){y(e,"fb-icon fa fa-facebook","Facebook"),e.find(".fb-icon").click(function(e){e.preventDefault();var i=t(this).parents(".tile:first").find("img.item"),n=t(this).parents(".tile:first").find(".caption"),s=r.settings.facebookText||document.title;!r.settings.facebookText&&1==n.length&&n.text().length>0&&(s=t.trim(n.text()));var a="http://www.facebook.com/sharer.php?u="+encodeURI(location.href.split("#")[0])+"&t="+encodeURI(s);if(1==i.length){var o=i.attr("src");a+="&p[images][0]="+z(o)}var h=window.open(a,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");h.moveTo(screen.width/2-300,screen.height/2-200)})},M=function(e){y(e,"pi-icon fa fa-pinterest","Pinterest"),e.find(".pi-icon").click(function(e){e.preventDefault();var i=t(this).parents(".tile:first").find("img.item"),n=t(this).parents(".tile:first").find(".caption"),s=r.settings.facebookText||document.title;!r.settings.facebookText&&1==n.length&&n.text().length>0&&(s=t.trim(n.text()));var a="http://pinterest.com/pin/create/button/?url="+encodeURI(location.href)+"&description="+encodeURI(s);if(1==i.length){var o=i.attr("src");a+="&media="+z(o)}var h=window.open(a,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");h.moveTo(screen.width/2-300,screen.height/2-200)})},_=function(t){y(t,"gp-icon fa fa-google-plus","G+"),t.find(".gp-icon").click(function(t){t.preventDefault();var e="https://plus.google.com/share?url="+encodeURI(location.href),i=window.open(e,"ftgw","location=1,status=1,scrollbars=1,width=600,height=400");i.moveTo(screen.width/2-300,screen.height/2-200)})},T=function(t,e){if(t.css({position:"absolute",left:"50%"}),e)for(var i in e)t.css(i,e[i]);t.find(".tile-inner").css({position:"relative"}),t.find(".item").css({width:"100%",display:"none"})},x=function(e){var i=t(e.shift());if(null==i.data("type")||"image"==i.data("type")){var n=i.find(".item"),s=new Image;n.attr("width")&&n.attr("height")&&!r.settings.ignoreImageAttributes?(C(i),Q(i),E(i),e.length>0&&x(e)):(s.onload=function(){i.find(".item").data("width",this.width*r.settings.imageSizeFactor).data("height",this.height*r.settings.imageSizeFactor),C(i),Q(i),E(i),e.length>0&&x(e)},s.onerror=function(){C(i),Q(i),E(i),e.length>0&&x(e)},s.src=n.attr("src"))}else C(i),Q(i),E(i),e.length>0&&x(e)},O=function(t){var e=[];t.each(function(t,i){e.push(i)}),x(e)},E=function(t){var e=t.find(".caption");if(e.length>0){e.css({position:"absolute",width:"100%",height:"100%",opacity:0});var i={enter:{},leave:{}};switch(r.settings.hoverEffect){default:case"fade":e.css({left:0,top:0}),i.enter.opacity=1,i.leave.opacity=0;break;case"slide-top":e.css({left:0,top:0-t.find(".item").data("size").height}),i.enter.top=0,i.leave.top=0-t.find(".item").data("size").height,i.enter.opacity=1,i.leave.opacity=0;break;case"slide-bottom":e.css({left:0,bottom:0-t.find(".item").data("size").height}),i.enter.bottom=0,i.leave.bottom=0-t.find(".item").data("size").height,i.enter.opacity=1,i.leave.opacity=0;break;case"slide-left":e.css({left:0-t.find(".item").data("size").width,top:0}),i.enter.left=0,i.leave.left=0-t.find(".item").data("size").width,i.enter.opacity=1,i.leave.opacity=0;break;case"slide-right":e.css({right:0-t.find(".item").data("size").width,top:0}),i.enter.right=0,i.leave.right=0-t.find(".item").data("size").width,i.enter.opacity=1,i.leave.opacity=0}t.mouseenter(function(){e.css("display","block"),e.animate(i.enter,r.settings.hoverEffectDuration,r.settings.hoverEasing,function(){})}),t.mouseleave(function(){e.animate(i.leave,r.settings.hoverEffectDuration,r.settings.hoverEasing,function(){})})}},C=function(e){e.each(function(){var e={},i=t(this).find(".item");(null==t(this).data("type")||"image"==t(this).data("type"))&&(i.attr("width")?e={width:parseInt(i.attr("width")),height:parseInt(i.attr("height"))}:(i.show(),e={width:i.data("width"),height:i.data("height")}),i.hide()),"video"==t(this).data("type")&&(e={width:parseInt(t(this).find("iframe").attr("width")),height:parseInt(t(this).find("iframe").attr("height"))}),i.data("size",e)})},Q=function(e){h||(h=new a(r.settings.gridCellSize,r.settings.margin,r.settings.minTileWidth,g.width()));var i=l?"all .5s":"none";e.css({transition:i}),e.find(".item").css({display:"block"}),e.each(function(){if(!t(this).hasClass("ftg-hidden")){t(this).show();var e=t(this).find(".item").data("size"),i=h.insert(e.width+r.settings.margin,e.height+r.settings.margin,r.settings.allowEnlargement);t(this).data("enlarged",i.enlarged),t(this).find(".caption").css({width:"100%"});var s=i.cell_size*i.position.y,a=i.cell_size*i.blocks.v,o=i.cell_size*i.blocks.h-r.settings.margin,c=i.cell_size*i.blocks.v-r.settings.margin;s+c>u&&(u=s+a+r.settings.margin),n()||!l?(t(this).css({top:s,left:i.cell_size*i.position.x,width:i.cell_size*i.blocks.h,height:a},500),t(this).find(".tile-inner").css({display:"block",overflow:"hidden"}).css({width:o,height:c}).data("width",o).data("height",c)):(t(this).animate({top:s,left:i.cell_size*i.position.x,width:i.cell_size*i.blocks.h,height:a},500),t(this).find(".tile-inner").css({display:"block",overflow:"hidden"}).animate({width:o,height:c}).data("width",o).data("height",c)),g.find(".ftg-items").height(u)}}),e.find("img.item").each(function(e,i){var n=t(i),s=n.data("size");n.css({marginTop:0,marginLeft:0,width:"100%",display:"block",fontSize:10,margin:"auto",maxWidth:"9999em"});var a=s.width/s.height,o=n.parent().data("width")/n.parent().data("height");if(n.parent().parent().data("enlarged")&&!r.settings.allowEnlargement)n.css({height:n.parent().data("height"),width:s.width,marginTop:0});else{if(a==o)return n.css({width:n.parent().data("width"),height:n.parent().data("height")}),n.attr("case","0"),void 0;if(a>=o){n.css({width:"auto",height:n.parent().data("height")}),n.attr("case","2");var h=n.width()-n.parent().data("width");n.css("margin-left",h/-2)}else{n.css({width:n.parent().data("width"),height:"auto"}),n.attr("case","4");var h=n.height()-n.parent().data("height");n.css("margin-top",h/-2)}}}),e.each(function(){var e=t(this);e.visible(!0)&&e.addClass("already-visible")}),p=g.width(),w?r.settings.onUpdate.call(r):(w=!0,r.settings.onComplete.call(r)),c=!1,r.hideLoading()};r.init()},t.fn.finalTilesGallery=function(e){return this.each(function(){if(void 0==t(this).data("finalTilesGallery")){var i=new t.finalTilesGallery(this,e);t(this).data("finalTilesGallery",i)}})}}(jQuery);